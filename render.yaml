# Render Blueprint: CodeReview AI
# Deploy backend and frontend as two web services. Link repo and apply this blueprint.
#
# After first deploy:
# 1. Set GROQ_API_KEY on the backend service (Environment).
# 2. Set NEXT_PUBLIC_API_URL on the frontend to your backend URL (e.g. https://code-reviewer-ai-backend.onrender.com).

services:
  - type: web
    name: code-reviewer-ai-backend
    runtime: python
    region: oregon
    rootDir: backend-python
    buildFilter:
      paths:
        - backend-python/**
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn app:app --host 0.0.0.0 --port $PORT
    healthCheckPath: /health
    envVars:
      - key: GROQ_API_KEY
        sync: false
        # Add your Groq API key in the Render Dashboard for this service

  - type: web
    name: code-reviewer-ai-frontend
    runtime: node
    region: oregon
    buildFilter:
      paths:
        - frontend/**
        - package.json
        - pnpm-lock.yaml
        - pnpm-workspace.yaml
    buildCommand: pnpm install && pnpm --prefix frontend build
    startCommand: pnpm --prefix frontend start
    envVars:
      - key: NEXT_PUBLIC_API_URL
        sync: false
        # Set to your backend URL, e.g. https://code-reviewer-ai-backend.onrender.com
